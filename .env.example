# mocrelay Environment Variables Configuration
# Copy this file to .env and customize

# =============================================================================
# Server Settings
# =============================================================================

# Address and port to listen on
# Default: 0.0.0.0:8234
MOCRELAY_SERVER_ADDR=0.0.0.0:8234

# Timeout for sending messages to clients
# Default: 10s
# Examples: 5s, 1m, 30s
MOCRELAY_SERVER_SEND_TIMEOUT=10s

# Interval for sending WebSocket ping frames
# Default: 1m
# Examples: 30s, 2m, 5m
MOCRELAY_SERVER_PING_DURATION=1m

# =============================================================================
# Relay Settings
# =============================================================================

# Maximum size of incoming WebSocket messages (bytes)
# Default: 100000
MOCRELAY_RELAY_MAX_MESSAGE_LENGTH=100000

# Rate limit: messages per second (float)
# Default: 10.0
MOCRELAY_RELAY_RECV_RATE_LIMIT_RATE=10.0

# Rate limit: burst size (integer)
# Default: 10
MOCRELAY_RELAY_RECV_RATE_LIMIT_BURST=10

# =============================================================================
# Handler Settings
# =============================================================================

# In-memory cache size (number of events)
# Default: 100
MOCRELAY_CACHE_SIZE=100

# Router size (number of concurrent subscriptions)
# Default: 100
MOCRELAY_ROUTER_SIZE=100

# =============================================================================
# SQLite Plugin Settings
# =============================================================================

# Enable/disable SQLite storage
# Default: true
MOCRELAY_SQLITE_ENABLED=true

# SQLite database file path
# Default: ./mocrelay.db
# Special values: ":memory:" for in-memory database
MOCRELAY_SQLITE_PATH=./mocrelay.db

# Number of events to accumulate before bulk insert
# Default: 1000
MOCRELAY_SQLITE_BULK_INSERT_NUM=1000

# Time interval for bulk insert (even if NUM not reached)
# Default: 2m
# Examples: 1m, 5m, 10m
MOCRELAY_SQLITE_BULK_INSERT_DURATION=2m

# Maximum limit value for queries
# Default: 5000
MOCRELAY_SQLITE_MAX_LIMIT=5000

# =============================================================================
# Prometheus Plugin Settings
# =============================================================================

# Enable/disable Prometheus metrics endpoint (/metrics)
# Default: true
MOCRELAY_PROMETHEUS_ENABLED=true

# =============================================================================
# NIP-11 Configuration
# =============================================================================

# Path to NIP-11 YAML configuration file
# Default: ./nip11.yaml
# If the file doesn't exist, built-in defaults are used
MOCRELAY_NIP11_FILE=./nip11.yaml

# =============================================================================
# NIP-11 Limitation Overrides
# =============================================================================
# These environment variables override values from nip11.yaml
# This allows keeping public relay info in YAML while using environment
# variables for operational/private settings

# Override maximum message length from NIP-11 limitation
# MOCRELAY_LIMITATION_MAX_MESSAGE_LENGTH=200000

# Override maximum subscriptions per connection
# MOCRELAY_LIMITATION_MAX_SUBSCRIPTIONS=20

# Override maximum filters per REQ message
# MOCRELAY_LIMITATION_MAX_FILTERS=10

# Override maximum limit value in filters
# MOCRELAY_LIMITATION_MAX_LIMIT=5000

# Override maximum subscription ID length
# MOCRELAY_LIMITATION_MAX_SUBID_LENGTH=100

# Override maximum event tags
# MOCRELAY_LIMITATION_MAX_EVENT_TAGS=2000

# Override maximum content length
# MOCRELAY_LIMITATION_MAX_CONTENT_LENGTH=10000

# Override minimum proof-of-work difficulty
# MOCRELAY_LIMITATION_MIN_POW_DIFFICULTY=0

# Override authentication requirement
# MOCRELAY_LIMITATION_AUTH_REQUIRED=false

# Override payment requirement
# MOCRELAY_LIMITATION_PAYMENT_REQUIRED=false

# Override created_at lower limit (Unix timestamp)
# MOCRELAY_LIMITATION_CREATED_AT_LOWER_LIMIT=1672531200

# Override created_at upper limit (Unix timestamp, 0 = no limit)
# MOCRELAY_LIMITATION_CREATED_AT_UPPER_LIMIT=0
