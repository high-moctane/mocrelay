# NIP-09: Event Deletion Request

**ステータス**: `draft` `optional` `relay`

## 概要

kind 5 による削除リクエスト。作者が過去のイベントの削除を要求できる。

## リレーの責務

### 削除処理

- **削除対象**: `e` タグまたは `a` タグで参照されたイベント
- **条件**: 削除リクエストの `pubkey` と対象イベントの `pubkey` が一致する場合のみ
- **動作**: イベントを削除、または配信を停止 SHOULD

### 削除リクエストの保存

- **削除リクエスト自体は保存し続ける** SHOULD
- 理由: クライアントが既に取得済みのイベントに対しても削除を通知するため

### `a` タグの扱い

- **Replaceable/Addressable イベント**: 削除リクエストの `created_at` までのすべてのバージョンを削除 SHOULD

## 実装ポイント

### イベント構造

```json
{
  "kind": 5,
  "pubkey": "<作者の公開鍵>",
  "tags": [
    ["e", "<削除したいイベントID>"],
    ["e", "<別のイベントID>"],
    ["a", "<kind>:<pubkey>:<d-identifier>"],
    ["k", "1"],
    ["k", "30023"]
  ],
  "content": "削除理由（任意）"
}
```

### バリデーション

- **pubkey の一致確認**: リレーは検証可能だが、必須ではない（参照先イベントを持っていない可能性）
- **k タグ**: 削除対象の kind を含める SHOULD（オプション）

### エッジケース

- **削除リクエストの削除リクエスト**: 効果なし。サポート不要
- **他人のイベントの削除**: pubkey が一致しない場合は無視
- **存在しないイベントの削除**: エラーにせず受け入れる（リレーが持っていないだけかもしれない）

## クライアント側の注意

リレーの責務ではないが、理解しておくべき点：

- クライアントは削除リクエストを検証すべき（pubkey の一致確認）
- すべてのリレーから削除されるわけではない（分散システムの性質）
- 削除は「完全な削除」を保証しない

## 他の NIP との関連

- **NIP-01**: 基本的なイベント構造
- **NIP-40**: Expiration（自動削除）との違い

## 参考

- [NIP-09 原文](https://github.com/nostr-protocol/nips/blob/master/09.md)
